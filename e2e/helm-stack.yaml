app:
  chartsDir: build/e2e/charts
  environmentsDir: build/e2e/clusters

repos:
- name: bitnami
  url: https://charts.bitnami.com/bitnami

- name: prometheus-community
  url: https://prometheus-community.github.io/helm-charts

charts:
# prometheus-operator chart using v1beta1 CRD
- name: bitnami/kube-prometheus@1.1.0
  namespaceInTemplate: true

# prometheus-operator using v1 CRD
- name: prometheus-community/kube-prometheus-stack@12.7.0
  namespaceInTemplate: true

- name: emqx@v4.2.3
  git:
    url: https://github.com/emqx/emqx-rel
    path: deploy/charts/emqx
- name: aranya@master
  local: {}
  namespaceInTemplate: true

environments:
#
# kubernetes v1.13
#
- name: v1-13
  kubeContext: kind-v1-13
  deployments:
  - name: emqx/emqx
    chart: emqx@v4.2.3

  - name: monitoring/promop
    # for v1beta1 CRD
    chart: bitnami/kube-prometheus@1.1.0
    state: novalidation

  - name: default/aranya
    chart: aranya@master

#
# kubernetes v1.14
#
- name: v1-14
  kubeContext: kind-v1-14
  deployments:
  - name: emqx/emqx
    chart: emqx@v4.2.3

  - name: monitoring/promop
    # for v1beta1 CRD
    chart: bitnami/kube-prometheus@1.1.0
    state: novalidation

  - name: default/aranya
    chart: aranya@master

#
# kubernetes v1.15
#
- name: v1-15
  kubeContext: kind-v1-15
  deployments:
  - name: emqx/emqx
    chart: emqx@v4.2.3

  - name: monitoring/promop
    # for v1beta1 CRD
    chart: bitnami/kube-prometheus@1.1.0
    state: novalidation

  - name: default/aranya
    chart: aranya@master

#
# kubernetes v1.16
#
- name: v1-16
  kubeContext: kind-v1-16
  deployments:
  - name: emqx/emqx
    chart: emqx@v4.2.3

  - name: monitoring/promop
    chart: prometheus-community/kube-prometheus-stack@12.7.0

  - name: default/aranya
    chart: aranya@master

#
# kubernetes v1.17
#
- name: v1-17
  kubeContext: kind-v1-17

  deployments:
  - name: emqx/emqx
    chart: emqx@v4.2.3

  - name: monitoring/promop
    chart: prometheus-community/kube-prometheus-stack@12.7.0

  - name: default/aranya
    chart: aranya@master

#
# kubernetes v1.18
#
- name: v1-18
  kubeContext: kind-v1-18

  deployments:
  - name: emqx/emqx
    chart: emqx@v4.2.3

  - name: monitoring/promop
    chart: prometheus-community/kube-prometheus-stack@12.7.0

  - name: default/aranya
    chart: aranya@master

#
# kubernetes v1.19
#
- name: v1-19
  kubeContext: kind-v1-19

  deployments:
  - name: emqx/emqx
    chart: emqx@v4.2.3

  - name: monitoring/promop
    chart: prometheus-community/kube-prometheus-stack@12.7.0

  - name: default/aranya
    chart: aranya@master
